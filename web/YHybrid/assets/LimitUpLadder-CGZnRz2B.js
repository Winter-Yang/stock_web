import{f as N,a as U}from"./limitUpModel-DYP1UZCr.js";import{_ as w,a as i,o as C,b as a,F as E,m as F,r as p,l as B,t as c,s as x}from"./index-DzOw8klO.js";const $={name:"LimitUpLadder",setup(){const m=p([]),y=p([]),_=p([]),o=()=>{const t=[{name:"首板",stocks:[],todayCount:0,yesterdayCount:0},{name:"1进2",stocks:[],todayCount:0,yesterdayCount:0},{name:"2进3",stocks:[],todayCount:0,yesterdayCount:0},{name:"3进4",stocks:[],todayCount:0,yesterdayCount:0},{name:"4进5",stocks:[],todayCount:0,yesterdayCount:0},{name:"5进6",stocks:[],todayCount:0,yesterdayCount:0},{name:"更高板",stocks:[],todayCount:0,yesterdayCount:0}];m.value.forEach(e=>{const s=e.limit_up_days-1;s>=0&&s<t.length&&(t[s].stocks.push(e),t[s].todayCount++)}),t.forEach(e=>{const s={};e.stocks.forEach(u=>{var v,S,L;const d=((L=(S=(v=u.surge_reason)==null?void 0:v.related_plates)==null?void 0:S[0])==null?void 0:L.plate_name)||"其他";s[d]||(s[d]=[]),s[d].push(u)});const f=Object.entries(s).sort((u,d)=>d[1].length-u[1].length);e.stocks=f.flatMap(([u,d])=>d)});const r=[{name:"首板",stocks:[],todayCount:0,yesterdayCount:0},{name:"1进2",stocks:[],todayCount:0,yesterdayCount:0},{name:"2进3",stocks:[],todayCount:0,yesterdayCount:0},{name:"3进4",stocks:[],todayCount:0,yesterdayCount:0},{name:"4进5",stocks:[],todayCount:0,yesterdayCount:0},{name:"5进6",stocks:[],todayCount:0,yesterdayCount:0},{name:"更高板",stocks:[],todayCount:0,yesterdayCount:0}];y.value.forEach(e=>{const s=e.yesterday_limit_up_days-1;s>=0&&s<t.length&&r[s].todayCount++}),console.log("昨日涨停"),console.log(r),t.forEach((e,s)=>{if(s==0)e.rate=`${e.todayCount}个`;else{e.yesterdayCount=r[s-1].todayCount;const f=e.yesterdayCount>0?(e.todayCount/e.yesterdayCount*100).toFixed(0):0;e.rate=`${e.todayCount}/${e.yesterdayCount}=${f}%`}}),_.value=t.reverse()},g=t=>t.startsWith("SZ")?"深":t.startsWith("SH")?"沪":"",k=t=>({failed:t.failed&&!t.yesterdayFailed,success:!t.failed,"yesterday-failed":t.yesterdayFailed}),l=t=>({up:t>0,down:t<0}),h=t=>`${(t*100).toFixed(2)}%`,n=t=>{var r,e;return((e=(r=t.surge_reason)==null?void 0:r.related_plates)==null?void 0:e.length)>0?t.surge_reason.related_plates[0].plate_name:""};return B(async()=>{try{const[t,r]=await Promise.all([N(),U()]);m.value=t,y.value=r,o()}catch(t){console.error("获取数据失败:",t)}}),{ladderLevels:_,getStockArea:g,getStockNameClass:k,getChangeClass:l,formatChange:h,getStockTag:n}}},b={class:"limit-up-ladder"},A={class:"ladder-content"},D={class:"level-info"},G={class:"level-name"},M={class:"level-rate"},T={class:"stock-list"},W={class:"stock-area"},j={class:"stock-tag"};function z(m,y,_,o,g,k){return C(),i("div",b,[y[0]||(y[0]=a("div",{class:"ladder-header"},[a("div",{class:"header-left"},"进度"),a("div",{class:"header-right"},"晋级率")],-1)),a("div",A,[(C(!0),i(E,null,F(o.ladderLevels,(l,h)=>(C(),i("div",{key:h,class:"ladder-row"},[a("div",D,[a("div",G,c(l.name),1),a("div",M,c(l.rate),1)]),a("div",T,[(C(!0),i(E,null,F(l.stocks,(n,t)=>(C(),i("div",{key:t,class:"stock-item"},[a("span",W,c(o.getStockArea(n.symbol)),1),a("span",{class:x(["stock-name",o.getStockNameClass(n)])},c(n.stock_chi_name),3),a("span",{class:x(["stock-change",o.getChangeClass(n.change_percent)])},c(o.formatChange(n.change_percent)),3),a("span",j,c(o.getStockTag(n)),1)]))),128))])]))),128))])])}const O=w($,[["render",z],["__scopeId","data-v-c1a34134"]]);export{O as default};
